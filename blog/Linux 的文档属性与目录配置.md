---
layout: post
title: Linux 的文档属性与目录配置
---
#### 前言
```
Linux 最优秀的地方之一，就在于他的多人多任务的环境。 而为了让各个使用者具有较安全的管理机制， 因此档案的权限管理就变的很重要了。 Linux 一般将档案可存取的方式分为三个类别，分别是 owner/group/other， 且各有 read/write/excute 等权限。若管理得当，将会让您的 Linux 主机变的较为安全。
```
#### 使用者与群组
```
档案拥有者  初次接触 Linux 的朋友大概会觉得很怪异，怎么『Linux 有这么多使用者，还分什么群组，有什么用？』。 
这个『使用者与群组』的功能可是相当健全而好用的一个安全防护呢！怎么说呢？ 由于 Linux 是个多人
多任务的系统 ( 已经提过若干次啰！ )，因此可能常常会有多人同时使用这部主机来进行工作的情况发生， 
为了考虑每个人的隐私权以及每个人的喜好的工作环境， 因此，这个『档案拥有者』的角色就显的相当的
重要了！ 
 
例如当你将你的 e-mail 情书转存成档案之后，放在您自己的家目录，您总不希望被其它人看见自己的情
书吧？ 这个时候，你就把该档案设定成『只有档案拥有者，就是我，才能看与修改这个档案的内容』， 那
么即使其它人知道你有这个相当『有趣』的档案，不过由于您有设定适当的权限， 所以其它人自然也就无
法知道该档案的内容啰！ 

群组概念  那么群组呢？为何要设定档案还有所属的群组？其实， 群组最简单的功能之一，就是当您在团队开发资源
的时候最有用啦！ 举个例子来说好了，假如在我的主机上面有两个团体，这第一个团体名称为 testgroup 
而他的成员是 test1, test2, test3 三个，第二个团体名称为 treatgoup 他的团员为 treat1, treat2, 
treat3，这两个团体之间是互相有竞争性质的， 但是却又要缴交同一份报告，然而每组团员又需要同时可
以修改自己的团体内任何人所建立的档案， 且不能让非自己团体的其它人看到自己的档案内容！这个时候
怎么办？ 
 
呵呵！在 Linux 底下可就很简单啦！我可以经由简易的档案权限设定，就能限制非自己团队( 亦即是群组
啰 )的其它人不能够阅览内容啰！而且亦可以让自己的团队成员可以修改我所建立的档案！ 同时，如果我
自己还有私人隐密的文件，仍然可以设定成让自己的团队成员也看不到我的档案数据。 很方便吧！ 
 
另外，如果 teacher 这个账号是 testgroup 与 treatgroup 这两个群组的老师， 他想要同时观察两者的
进度，因此需要两边的群组都能够进去观看，这个时候，您可以设定 teacher 这个账号，『同时支持 
testgroup 与 treatgroup 这两个群组！』，也就是说， 每个人都可以有多个群组的支持呢！ 
 
这样说或许你还不容易理解这个使用者与群组的关系吧？没关系，我们可以使用目前『家庭』的观念来进
行解说喔！ 假设有一家人，家里只有三兄弟，分别是王大毛、王二毛与王三毛三个人， 而这个家庭是登
记在王大毛的名下的！所以，『王大毛家有三个人，分别是王大毛、王二毛与王三毛』， 而且这三个人都
有自己的房间，并且共同拥有一个客厅喔！
  
由于王家三个人各自拥有自己的房间，所以，王二毛虽然可以进入王三毛的房间， 但是二毛不能 翻三毛的抽屉喔！那样会被三毛 K 的！因为抽屉里面可能有三毛自己私人的东西，例如情书啦，
日记啦等等的， 这是『私人的空间』，所以当然不能让二毛拿啰！ ? 由于共同拥有客厅，所以王家三兄弟可以在客厅打开电视机啦、翻阅报纸啦、坐在沙发上面发呆 啦等等的！ 反正，只要是在客厅的玩意儿，三兄弟都可以使用喔！因为大家都是一家人嘛！ 
这样说来应该有点晓得了喔！那个『王大毛家』就是所谓的『群组』啰， 至于三兄弟就是分别为三个『使
用者』，而这三个使用者是在同一个群组里面的喔！ 而三个使用者虽然在同一群组内，但是我们可以设定
『权限』， 好让某些使用者个人的信息不被群组的所有人查询，以保有个人『私人的空间』啦！ 而设定
群组共享，则可让大家共同分享喔！ 

其它人的概念  好了，那么今天又有个人，叫做张小猪，他是张小猪家的人，与王家没有关系啦！ 这个时候，除非王家认
识张小猪，然后开门让张小猪进来王家，否则张小猪永远没有办法进入王家， 更不要说进到王三毛的房间
啦！不过，如果张小猪透过关系认识了三毛，并且跟王三毛成为好朋友， 那么张小猪就可以透过三毛进入
王家啦！呵呵！没错！那个张小猪就是所谓的『其它人， Others 』啰！ 
 
因此，我们就可以知道啦，在 Linux 里面，任何一个档案都具有『User, Group 及 Others』三个权限！
我们可以将上面的说明以底下的图示来解释： 

 
图一、每个档案的拥有者、群组与其它人的示意图 
 王三毛家：王大毛。王二毛，玩三毛
 天神
 张小猪:张小猪
此时，以王三毛为例，王三毛这个『档案』的拥有者为王三毛，他属于王大毛这个群组， 而张小猪相对于
王三毛，则只是一个『其它人(others)』而已。 
 
不过，这里有个特殊的人物要来介绍的，那就是『万能的天神』！这个天神具有无限的神力， 所以他可以
到达任何他想要去的地方，呵呵！那个人在 Linux 系统中的身份代号是『 root 』啦！所以要小心喔！那
个 root 可是『万能的天神』喔！ 
 
无论如何，『使用者身份』，与该使用者所支持的『群组』概念，在 Linux 的世界里面是相当的重要的，
他可以帮助您让您的多任务 Linux 环境变的更容易管理！更详细的 『身份与群组』 设定，我们将在 账
号管理 再进行解说。底下我们将针对档案系统与档案权限来进行说明。 

Linux 使用者身份与群组记录的档案  在我们 Linux 系统当中，预设的情况下，所有的系统上的账号与一般身份使用者，还有那个 root 的相关
信息，都是记录在 /etc/passwd 这个档案内的。至于密码则是记录在 /etc/shadow 这个档案下。 此外， 
Linux 所有的群组名称都纪录在 /etc/group 内！这三个档案可以说是 Linux 系统里面账号、密码、群组
信息的集中地啰！不要随便删除这三个档案啊！ ^_^ 
 


 


```
#### Linux 档案属性
```
drwxr-xr-x 6 jagent jagent  4096 Dec  2 21:12 ./
drwxr-xr-x 5 root   root    4096 Jan  9  2020 ../
-rw------- 1 jagent jagent 17593 Dec  6 19:47 .bash_history
-rw-r--r-- 1 jagent jagent   220 Apr 10  2019 .bash_logout
-rw-r--r-- 1 jagent jagent  3676 Sep 25 02:47 .bashrc
drwx------ 2 jagent jagent  4096 May 29  2019 .cache/
-r-------- 1 jagent jagent   186 Nov 17 20:48 .p4tickets
-rw-r--r-- 1 jagent jagent   675 Apr 10  2019 .profile
drwx------ 2 jagent jagent  4096 Sep 23  2019 .ssh/
drwxrwxr-x 2 jagent jagent  4096 Sep 17 03:46 testtest/
-rw------- 1 jagent jagent  3662 Oct 19 22:33 .viminfo
-rw------- 1 jagent jagent   104 Dec  2 21:12 .Xauthority
drwxrwxr-x 2 jagent jagent  4096 Sep 17 04:33 xzt_mount/
第一栏代表这个档案的属性： 这个地方最需要注意了！仔细看的话，你应该可以发现这一栏其实 共有十个属性：drwxrwxr-x
第一个属性代表这个档案是目录、档案或连结文件等等：
当为[ d ]则是目录，例如上表的第 1 行；  
当为[ - ]则是档案，例如上表的第 3 行；  
若是[ l ]则表示为连结档(link file)；  
若是[ b ]则表示为装置文件里面的可供储存的接口设备
若是[ c ]则表示为装置文件里面的串行端口设备，例如键盘、鼠标。 
接下来的属性中，三个为一组，且均为『rwx』 的三个参数的组合。其中，[ r ]代表可 读(read)、[ w ]代表可写(write)、[ x ]代表可执行(excute)：  
第一组为『拥有人的权限』，以第 3 行为例，该档案的拥有人可以读写，但不可执行；  
第二组为『同群组的权限』；  
第三组为『其它非本群组的权限』。
 
范例：若有一个档案的属性为『-rwxr-xr--』，简单的可由下面说明之：  
[-][rwx][r-x][r--] 
 1  234  567  890 
     1 为：代表这个文件名为目录或档案（上面为档案） 
    234 为：拥有人的权限（上面为可读、可写、可执行） 
    567 为：同群组使用者权限（上面为可读可执行） 
    890 为：其它使用者权限（上面为仅可读） 
上面的属性情况代表一个档案、这个档案的拥有人可读可写可执行、但同群组的人仅可读与执行， 
非同群组的使用者仅可读的意思！ 
除此之外，需要特别留意的是 x 这个标号！ 若文件名为一个目录的时候，例如上表中的 .ssh 这
个目录： 
drwx------   3   root    root    4096    Jun 25 08:35    .ssh 
可以看到这是一个目录，而且只有 root 可以读写与执行。但是若为底下的样式时，请问非 root 
其它人是否可以进入该目录呢？
drwxr--r--   3   root    root    4096    Jun 25 08:35    .ssh 
的
 
咦！似乎好像是可以喔！因为有可读[ r ]存在嘛！『错！』答案是非 root 这个账号的其它使用
均不可进入 .ssh 这个目录，为什么呢？ 因为 x 与 目录 的关系相当的重要， 如果您在该目
录底下不能执行任何指令的话，那么自然也就无法进入了，因此， 请特别留意的是，如果您想要
开放某个目录让一些人进来的话， 请记得将该目录的 x 属性给开放呦

在 Windows 底下一个档案是否具有执行的能力是藉由『 附名 』来判断的， 例如：.exe, .bat, .com 等等，但是在 Linux 底下， 我们的档案是否能执
行，则是藉由是否具有 x 这个属性来决定的！所以，跟档名是没有绝对的关系的！ 这点还请特
别留意呢！

第二栏表示为连结占用的节点 (i-node)： 这个跟连结档 (link file) 比较有关系， 如果是目录的话，那么就与该目录下还有多少目录有关。 

第三栏表示这个档案（或目录）的『拥有人』。 

第四栏表示拥有人的群组。 
这里再次解释一下，在 Linux 中，你的 ID ( 如 root 或 test 等账号均是所谓的 ID ) 即是你
个或多个群组之下，例如刚刚我们上面提到的，你有一个团体 ( 即
群组 ) 代号为 testgroup ，且这个群体里有三个人，其代号分别是 test1, test2, 与 test3，
则这三个人为同一群组即 testgroup！那么如果以上图的的档案属性(-rwxrwx---) 来看，如果该
档案属于 test1 所有，那么 test2, test3 亦有读、写、执行的权力，因为他们都属于同一个 
group 呀！而如果您不是属于 test1, test2, test3 的任何一个人，也不属于 testgroup 这个
群组时，那么您将不具备读、写、执行这个档案的权限了！ 

第五栏为这个档案的容量大小

第六栏为这个档案的建档日期或者是最近的修改日期， 分别为月份、日期及时间。请特别留意，
如果您是以繁体中文来进行安装您的 Linux 时，那么预设的语系可能会被改为中文。而 由于中
文无法显示在文字型态的终端机上面， 所以这一栏会成为怪怪的乱码，这个时候，请修改一下 
/etc/sysconfig/i18n 这个档案，里面的『 LC_TIME 』修改为：『 LC_TIME=en 』再储存离开，
再登入一次，就可以得到英文字形显示的日期了！ 那么如何修改该档案呢？呵呵！以 root 身份
用 vi 修改。 另外，也可以使用『 LANG=en ls -al 』之类的语法来显示。

第七栏为这个档案的档名， 如果档名之前多一个『 . 』，则代表这个档案为『
 隐藏档』， 例如 上表第 6 行的『.bashrc_history』档名即是隐藏档，由于我们有下一个参数为 ls -al，所以连
隐藏档都列出来，如果你只输入 ls 则档名有加『 . 』的档案就不会被显示出来！

Linux 档案属性的重要性：  与 Windows 系统不一样的是，在 Linux 系统（或者说 Unix-Like 系统）当中，每一个档案都多加了很多
的属性进来，尤其是群组的概念，这样有什么用途呢？ 基本上，最大的用途是在『安全性』上面的。举个
简单的例子，在你的系统中，关于系统服务的档案通常只有 root 才能读写，或者是执行，例如 /etc/shadow 
这一个账号管理的档案，由于该档案记录了你的系统中的所有账号的数据，因此是很重要的一个信息文件，
当然不能让任何人读取，只有 root 才能够来读取啰！所以该档案的属性就会成为 [ -rw------- ]啰


那么，如果你有一个开发团队，在你的团队中，你希望每个人都可以使用某一些目录下的档案， 而非你的
团队的其它人则不予以开放呢？以上面的例子来说，testgroup 的团队共有三个人，分别是 test1, test2, test3 ！
那么我就可以将 test1 的档案属性订为 [ -rwxrwx--- ] 来提供给 testgroup 的工作团队使用
啰！这可是相当重要的

再举个例子来说，如果你的目录权限没有作好的话，可能造成其它人都可以在你的系统上面乱搞啰！例如
本来只有 root 才能做的开关机、ADSL 的拨接程序、新增或删除使用者等等的指令，若被你改成任何人都
可以执行的话， 那么如果使用者不小心给你重新开机啦！重新拨接啦！等等的！那么你的系统不就会常常
莫名其妙的挂掉啰！ 而且万一你的使用者的密码被其它不明人士取得的话，只要他登入你的系统就可以轻
而易举的执行一些 root 的工作！可怕吧！因此，在你修改你的 linux 档案与目录的属性之前， 一定要
先搞清楚，什么是可变的，什么是不可变的！千万注意啰 
'''
#### 档案权限设定
```
chgrp ：改变档案所属群组  
chown ：改变档案所属人  
chmod ：改变档案的属性、 SUID 等等的特性 
 
 改变所属群组, chgrp  
改变一个档案的群组真是很简单的，直接以 chgrp 来改变即可，咦！这个指令就是 change group 的缩写
嘛！对啦！这样就很好记了吧！ ^_^。不过，请记得， 要改变成为的群组名称必须要在 /etc/group 里面
存在的名称才行，否则就会显示错误！

改变档案拥有者, chown  
既然改变群组是 change group ，那么改变拥有者就是 change owner 啰！BINGO，对啦！那就是 chown 这个指令的用途，要注意的是，使用者必须是已经
存在系统中的，也就是在 /etc/passwd 这个档案中有纪录的使用者名称才行改变。 
chown 的用途还满多的，他还可以顺便直接修改群组的名称呢！此外， 如果要连目录下的所有次目录或档
案同时更改档案拥有者的话，直接加上 -R 的参数即可！我们来看看语法与范例

[root@linux ~]# chown [-R] 账号名称 档案或目录 
[root@linux ~]# chown [-R] 账号名称:群组名称 档案或目录 
参数： 
-R : 进行递归( recursive )的持续变更，亦即连同次目录下的所有档案、目录 
     都更新成为这个群组之意。常常用在变更某一目录的情况。 
范例： 
[root@linux ~]# chown bin install.log 
[root@linux ~]# ls -l 
-rw-r--r--  1 bin  users 68495 Jun 25 08:53 install.log 
[root@linux ~]# chown root:root install.log 
[root@linux ~]# ls -l 
-rw-r--r--  1 root root 68495 Jun 25 08:53 install.log
嗯！知道如何改变档案的群组与拥有者了，那么什么时候要使用 chown 或 chgrp 呢？！或许您会觉得奇
怪吧？！是的，确实有时候需要变更档案的拥有者的， 最常见的例子就是在 copy 档案给你之外的其它人
时，我们使用最简单的 cp 来说明好了： 
[root@linux ~]# cp 来源档案 目的档案 
假设您今天要将 .bashrc 这个档案拷贝成为 .bashrc_test ，且是要给 bin 这个人，您可以这样做： 
[root@linux ~]# cp .bashrc .bashrc_test 
[root@linux ~]# ls -al .bashrc* 
-rw-r--r--  1 root root 395 Jul  4 11:45 .bashrc 
-rw-r--r--  1 root root 395 Jul 13 11:31 .bashrc_test 
哇！怎么办？ .bashrc_test 还是属于 root 所有，如此一来，即使你将档案拿给 bin 这个使用者了，那
他仍然无法修改的( 看属性就知道了吧！ )， 所以你就必须要将这个档案的拥有者与群组修改一下啰！知
道如何修改了吧 
 
改变九个属性, chmod  
档案属性的改变使用的是 chmod 这个指令，但是，属性的设定方法有两种， 分别可以使用数字或者是符
号来进行属性的变更。我们就来谈一谈

数字类型改变档案权限  
Linux 档案的基本属性就有九个，分别是 owner/group/others 组别的 read/write/excute 属性， 
先复习一下刚刚上面提到的数据
-rwxrwxrwx 
这九个属性是三个三个一组的！其中，我们可以使用数字来代表各个属性，各属性的对照表如下：
							r:4 
							w:2 
							x:1  
同一组 (owner/group/others) 的三个属性 (r/w/x) 是需要累加的，例如当属性为 [-rwxrwx---] 则是：  
						owner = rwx = 4+2+1 = 7 
						group = rwx = 4+2+1 = 7
						others= --- = 0+0+0 = 0 
[root@linux ~]# chmod [-R] xyz 档案或目录 
参数： 
xyz : 就是刚刚提到的数字类型的权限属性，为 rwx 属性数值的相加。 
-R : 进行递归( recursive )的持续变更，亦即连同次目录下的所有档案、目录 
     都更新成为这个群组之意。常常用在变更某一目录的情况。
	 

符号类型改变档案权限 
从之前的介绍中我们可以发现，基本上就九个属性分别是(1)user (2)group (3)others 三群啦！
那么我们就可以藉由 u, g, o 来代表三群的属性！此外， a 则代表 all 亦即全部的
三群！那么读写的属性就可以写成了 r, w, x 啰！也就是可以使用底下的方式来看

chmod  u/g/o/a  +(加入)/-(除去)/=(设定)   r/w/x 档案或目录 

```
#### 档案属性与目录配置
```
目录属性的意义:
r (read contents in directory)： 表示具有读取目录结构清单的权限，
所以当您具有读取 (r) 一个目录的权限时， 您就可以利用 ls 这个指令将该目录的内容列表显示出来！ 

w (modify contents of directory)： 这个可写入的权限对目录来说，是很了不起的！ 因为他 表示您将具有异动该目录结构清单的权限，也就是底下这些权限：

建立新的档案与目录；  
将已存在的档案或目录进行 更名
删除已经存在的档案与目录(不论该档案是属于谁的！)
搬移该目录内的档案、目录位置

x (access directory)： 这个 x 与能否进入该目录有关呢

Linux 档案种类与附档名
我们在刚刚的属性介绍中提到了最前面的标志 ( d 或 - ) 可以代表目录或档案，那就是不同的档案种类
种类主要有底下这几种：

正规档案 (regular file )： 就是一般我们在进行存取的类型的档案，在由 ls –al 所显示出 来的属性方面，
第一个属性为 [ - ]，例如 [-rwxrwxrwx ]。另外，依照档案的内容，又大略可以分为：

o 纯文字文件(ASCII)：这是 Unix 系统中最多的一种档案类型啰，称为纯文字文件是因为 内容为我们人类可以直接读到的数据， 例如数字、字母等等。几乎只要我们可以用来做
为设定的档案都属于这一种档案类型。 举例来说，您可以下达『 cat ~/.bashrc 』就
可以看到该档案的内容。 (cat 是将一个档案内容读出来的指令)

o 二进制文件(binary)：还记得我们在『 Linux 是什么 』那一章里面的 GNU 发展史中提 过， 我们的系统其实仅认识且可以执行二进制档案 (binary file) 吧？没错～ 您的 
Linux 当中的可执行档 (scripts, 文字型批次文件不算) 就是这种格式的啦～ 举例来
说，刚刚下达的指令 cat 就是一个 binary file 。 

o 数据格式文件(data)： 有些程序在运作的过程当中会读取某些特定格式的档案，那些特 定格式的档案可以被称为数据文件 (data file)。举例来说，我们的 Linux 在使用者登
入时，都会将登录的数据记录在 /var/log/wtmp 那个档案内，该档案是一个 data 
file ，他能够透过 last 这个指令读出来！ 但是使用 cat 时，会读出乱码～因为他是
属于一种特殊格式的档案。瞭乎？
 
目录 (directory)：就是目录啰～第一个属性为 [ d ]，例如 [drwxrwxrwx]。

连结档 (link)：就是类似 Windows 底下的快捷方式啦！第一个属性为 [ l ]， 例如 [lrwxrwxrwx] ； 
 
设备与装置文件 (device)：与系统周边及储存等相关的一些档案， 通常都集中在 /dev 这个目 录之下！通常又分为两种：
--区块 (block) 设备档 ：就是一些储存数据， 以提供系统存取的接口设备，简单的说就 是硬盘啦！例如你的一号硬盘的代码是 /dev/hda1 等等的档案啦！第一个属性为 [ b ]； 
--字符 (character) 设备档 ：亦即是一些串行端口的接口设备， 例如键盘、鼠标等等！ 第一个属性为 [ c ]。 
 
资料接口文件 (sockets)：既然被称为数据接口文件， 想当然尔，这种类型的档案通常被用在网 络上的数据承接了。我们可以启动一个程序来监听客户端的要求， 而客户端就可以透过这个 socket 来进行数据的沟通了。第一个属性为 [ s ]， 最常在 /var/run 这个目录中看到这种档
案类型了。 

数据输送文件 (FIFO, pipe)： FIFO 也是一种特殊的档案类型，他主要的目的在解决多个程序同 时存取一个档案所造成的错误问题。 FIFO 是 first-in-first-out 的缩写。第一个属性为 [p] 

那么使用刚刚的『 ls -al 』这个指令，你就可以简单的经由判断每一个档案的 第一个属性来了解这个档
案是何种类型！很简单吧！ 除了设备文件是我们系统中很重要的档案，最好不要随意修改之外（通常他也
不会让你修改的啦！）， 另一个比较有趣的档案就是连结档。如果你常常将应用程序捉到桌面来的话，你
就应该知道在 Windows 底下有所谓的『快捷方式』。同样的，你可以将 linux 下的连结档简单的视为一
个档案或目录的快捷方式。至于 socket 与 FIFO 档案比较难理解， 因为这两个咚咚与程序 (process) 比
较有关系，这个等到未来您了解 process 之后， 再回来看

一般可以执行附档名
*.sh ： 批次檔 ( scripts )，因为批次档为使用 shell 写成的，所以附档名就编成 .sh 啰； 
? *Z, *.tar, *.tar.gz, *.zip, *.tgz： 经过打包的压缩档。这是因为压缩软件分别为 gunzip, tar 等等的，由于不同的压缩软件，而取其相关的附档名啰！ 
? *.html, *.php：网页相关档案，分别代表 HTML 语法与 PHP 语法的网页档案啰！ .html 的档案 可使用网页浏览器来直接开启，至于 .php 的档案， 则可以透过 client 端的浏览器来 server 端浏览，以得到运算后的网页结果呢！
 
Linux 文件名称的限制： 
由于 Linux 在文字接口下的一些指令操作关系，一般来说，您在设定 Linux 底下的文件名称时， 最好可
以避免一些特殊字符比较好！例如底下这些：  
* ? > < ; & ! [ ] | \ ' " ` ( ) { } 
因为这些符号在文字接口下，是有特殊意义的！另外，文件名称的开头为小数点『.』时， 代表这个档案
为『隐藏档』喔！同时，由于指令下达当中，常常会使用到 -option 之类的参数， 所以您最好也避免将
档案档名的开头以 - 或 + 来命名啊！ 
```
